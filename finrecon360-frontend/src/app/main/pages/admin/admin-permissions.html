<mat-card>
  <div class="perm__header">
    <div>
      <h2>{{ 'ADMIN.PERMISSIONS.TITLE' | translate }}</h2>
      <p>{{ 'ADMIN.PERMISSIONS.COPY' | translate }}</p>
    </div>
    <button mat-flat-button color="primary" (click)="save()">
      {{ 'ADMIN.PERMISSIONS.SAVE' | translate }}
    </button>
  </div>

  <form class="perm__filters" [formGroup]="form">
    <mat-form-field appearance="outline">
      <mat-label>{{ 'ADMIN.PERMISSIONS.ROLE' | translate }}</mat-label>
      <mat-select formControlName="roleId">
        <mat-option *ngFor="let role of roles" [value]="role.id">
          {{ role.name }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>{{ 'ADMIN.PERMISSIONS.SEARCH' | translate }}</mat-label>
      <input matInput formControlName="search" />
    </mat-form-field>
  </form>

  <div class="perm__matrix">
    <table mat-table [dataSource]="filteredComponents()" class="mat-elevation-z1">
      <ng-container matColumnDef="component">
        <th mat-header-cell *matHeaderCellDef sticky>{{ 'ADMIN.PERMISSIONS.COMPONENT' | translate }}</th>
        <td mat-cell *matCellDef="let c">
          <div class="perm__component">
            <span class="perm__component-name">{{ c.name }}</span>
            <span class="perm__component-code">{{ c.code }}</span>
          </div>
        </td>
      </ng-container>

      <ng-container *ngFor="let action of actions" [matColumnDef]="action.code">
        <th mat-header-cell *matHeaderCellDef sticky>
          {{ action.name | translate }}
        </th>
        <td mat-cell *matCellDef="let c">
          <mat-checkbox
            [checked]="isChecked(c.id, action.code)"
            (change)="toggle(c, action)"
          ></mat-checkbox>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
</mat-card>
